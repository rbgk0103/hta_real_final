<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace='chat'>
	<select id="chat_table_no" parameterType="String" resultType="int">
		select tbl_no from table_status where tbl_ip = #{_ip}
	</select>
	<select id="chat_table_list" parameterType="bean.ChatDao" resultType="bean.TblVo">
		select * from (
			select rownum num, tbl.* from (
				select tbl_no, tbl_ip from table_status where tbl_ip is not null order by tbl_no
				) tbl
			) where num between #{startNo} and #{endNo}
	</select>
	<select id="chat_count" resultType="int">
		select count(guest_status)-1 from guest where guest_status = 1
	</select>
	<select id="chat_open_list" resultType="bean.GuestVo" parameterType="bean.ChatDao">
		select * from (
			select rownum num, g.* from (
				select table_no, guest_status, guest_gender
				from guest where guest_status = 1 and table_no != #{tableNo}
				order by table_no
			) g
		) where num between #{startNo} and #{endNo}
	</select>
	<select id='chat_all_list' resultType="bean.GuestVo">
		select table_no, guest_status, guest_gender 
		from guest where guest_status = 1 
		order by table_no
	</select>
</mapper>